<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø´Ø±Ø­ Random Forest Ù„Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ø³Ù„Ø§Ø³Ù„ Ø§Ù„Ø²Ù…Ù†ÙŠØ©</title>
  <style>
    :root {
      --bg: #0b1020;
      --card: #121a2b;
      --muted: #94a3b8;
      --text: #e2e8f0;
      --accent: #7c3aed;
      --accent-2: #22d3ee;
      --success: #10b981;
      --danger: #ef4444;
      --shadow: 0 10px 30px rgba(0,0,0,0.25);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 100% -10%, rgba(124,58,237,0.15), transparent 60%),
                  radial-gradient(800px 400px at -10% 110%, rgba(34,211,238,0.12), transparent 60%),
                  var(--bg);
      color: var(--text);
    }
    header {
      position: sticky; top: 0; z-index: 10;
      backdrop-filter: blur(8px);
      background: rgba(11,16,32,0.7);
      border-bottom: 1px solid rgba(148,163,184,0.1);
    }
    .container { max-width: 1100px; margin: 0 auto; padding: 20px; }
    .nav { display: flex; gap: 16px; flex-wrap: wrap; align-items: center; justify-content: space-between; }
    .brand { font-weight: 800; letter-spacing: .5px; }
    .tag { padding: 6px 10px; border-radius: 999px; background: rgba(124,58,237,0.15); color: #e9d5ff; border: 1px solid rgba(124,58,237,0.35); }
    .toc { display: flex; gap: 10px; flex-wrap: wrap; }
    .toc a { text-decoration: none; color: var(--muted); padding: 8px 12px; border-radius: 999px; border: 1px solid rgba(148,163,184,0.2); transition: 200ms; }
    .toc a:hover { color: var(--text); border-color: rgba(124,58,237,0.5); box-shadow: var(--shadow); }
    main { padding: 32px 0 60px; }

    .hero { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0)); border: 1px solid rgba(148,163,184,0.15); border-radius: 24px; padding: 28px; box-shadow: var(--shadow); }
    .hero h1 { margin: 0 0 8px; font-size: 28px; }
    .hero p { margin: 0; color: var(--muted); }

    section { margin-top: 28px; background: rgba(18,26,43,0.75); border: 1px solid rgba(148,163,184,0.15); border-radius: 20px; padding: 22px; box-shadow: var(--shadow); }
    section h2 { margin-top: 0; font-size: 22px; }
    .kpi { display: inline-flex; gap: 10px; align-items: center; padding: 8px 12px; border-radius: 12px; background: rgba(16,185,129,0.12); color: #d1fae5; border: 1px solid rgba(16,185,129,0.35); }

    .formula { direction: ltr; background: #0a0f1b; padding: 14px; border-radius: 14px; overflow-x: auto; border: 1px solid rgba(148,163,184,0.18); }

    .list { line-height: 1.9; }

    pre { margin: 0; }
    .codeblock { position: relative; background: #0a0f1b; border: 1px solid rgba(148,163,184,0.18); border-radius: 16px; padding: 14px; overflow: auto; }
    .copy {
      position: absolute; inset-inline-start: 10px; inset-block-start: 10px; background: rgba(124,58,237,0.2);
      border: 1px solid rgba(124,58,237,0.5); color: #f5f3ff; padding: 6px 10px; border-radius: 10px; cursor: pointer;
    }
    code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 13px; color: #d6e1ff; }
    .example-card { display: grid; gap: 8px; grid-template-columns: 1fr 1fr; }
    .pill { display:inline-block; padding: 4px 10px; border-radius: 999px; border:1px solid rgba(148,163,184,0.25); color: var(--muted); }

    footer { color: var(--muted); text-align: center; padding: 30px 0 50px; }
    @media (max-width: 720px){ .example-card { grid-template-columns: 1fr; } }
  </style>
  <!-- MathJax for LaTeX rendering -->
  <script>
    window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] } };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">ğŸŒ² Random Forest â€” Ø§Ù„Ø³Ù„Ø§Ø³Ù„ Ø§Ù„Ø²Ù…Ù†ÙŠØ©</div>
      <span class="tag">Ø¯Ù„ÙŠÙ„ Ø¹Ù…Ù„ÙŠ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
      <nav class="toc">
        <a href="#idea">Ø§Ù„ÙÙƒØ±Ø©</a>
        <a href="#formula">Ø§Ù„ØµÙŠØºØ©</a>
        <a href="#components">Ù…ÙƒÙˆÙ‘Ù†Ø§Øª Ø§Ù„ØµÙŠØºØ©</a>
        <a href="#example">Ù…Ø«Ø§Ù„ ØªØ·Ø¨ÙŠÙ‚ÙŠ</a>
        <a href="#pros">Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</a>
        <a href="#cons">Ø§Ù„Ø¹ÙŠÙˆØ¨</a>
        <a href="#code">Ø§Ù„ÙƒÙˆØ¯</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="hero">
      <h1>Ø´Ø±Ø­ Random Forest Ù„Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ø³Ù„Ø§Ø³Ù„ Ø§Ù„Ø²Ù…Ù†ÙŠØ© (Time Series)</h1>
      <p>Ù†Ø­ÙˆÙ‘Ù„ Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ø¥Ù„Ù‰ Ù…Ø´ÙƒÙ„Ø© ØªØ¹Ù„Ù… Ù…ÙØ±Ø§Ù‚ÙØ¨ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <span class="pill">Lag Features</span> Ø«Ù… Ù†Ø¯Ø±Ù‘Ø¨ ØºØ§Ø¨Ø© Ù…Ù† Ø£Ø´Ø¬Ø§Ø± Ø§Ù„Ù‚Ø±Ø§Ø± ÙˆÙ†Ø§Ø®Ø° Ù…ØªÙˆØ³Ø· ØªÙ†Ø¨Ø¤Ø§ØªÙ‡Ø§ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙˆÙ‚Ø¹ Ù…Ø³ØªÙ‚Ø± ÙˆØ¯Ù‚ÙŠÙ‚ Ù†Ø³Ø¨ÙŠÙ‹Ø§.</p>
    </div>

    <section id="idea">
      <h2>1) Ø§Ù„ÙÙƒØ±Ø©</h2>
      <p>
        <strong>Random Forest</strong> Ù‡ÙŠ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© <em>Ensemble</em> ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø¨Ù†Ø§Ø¡ Ø¹Ø¯Ø¯ ÙƒØ¨ÙŠØ± Ù…Ù† Ø£Ø´Ø¬Ø§Ø± Ø§Ù„Ù‚Ø±Ø§Ø± Ø¹Ù„Ù‰ Ø¹ÙŠÙ†Ø§Øª ÙˆØ®ØµØ§Ø¦Øµ Ù…Ø®ØªÙ„ÙØ© (Bagging + Feature Subsampling)ØŒ Ø«Ù… ØªØ¬Ù…ÙŠØ¹ Ù†ØªØ§Ø¦Ø¬Ù‡Ø§:
        ÙÙŠ Ø§Ù„Ø§Ù†Ø­Ø¯Ø§Ø± Ù†Ø£Ø®Ø° <strong>Ø§Ù„Ù…ØªÙˆØ³Ø·</strong> ÙˆÙÙŠ Ø§Ù„ØªØµÙ†ÙŠÙ Ù†Ø£Ø®Ø° <strong>Ø§Ù„ØªØµÙˆÙŠØª</strong>.
        ÙÙŠ Ø§Ù„Ø³Ù„Ø§Ø³Ù„ Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ù†ÙÙ†Ø´Ø¦ Ù…ÙŠØ²Ø§Øª Ø¥Ø²Ø§Ø­Ø© <span class="pill">lags</span> ÙˆÙ…ÙŠØ²Ø§Øª Ù…ØªØ­Ø±ÙƒØ© (Ù…Ø«Ù„ Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…ØªØ­Ø±Ùƒ) Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø§Ø¶ÙŠ ÙˆØ§Ù„Ø­Ø§Ø¶Ø±.
      </p>
    </section>

    <section id="formula">
      <h2>2) Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</h2>
      <div class="formula">
        $$\hat{y}(x) = \frac{1}{N} \sum_{i=1}^{N} T_i(x)$$
      </div>
      <p>Ø­ÙŠØ« \(N\) Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ø¬Ø§Ø±ØŒ Ùˆ \(T_i(x)\) Ù‡Ùˆ ØªÙ†Ø¨Ø¤ Ø§Ù„Ø´Ø¬Ø±Ø© Ø±Ù‚Ù… \(i\) Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø«Ø§Ù„ \(x\).</p>
    </section>

    <section id="components">
      <h2>3) Ø´Ø±Ø­ Ù„Ù…ÙƒÙˆÙ‘Ù†Ø§Øª Ø§Ù„ØµÙŠØºØ©</h2>
      <ul class="list">
        <li><strong>\(T_i(x)\):</strong> Ø´Ø¬Ø±Ø© Ù‚Ø±Ø§Ø± ØªØªÙƒÙˆÙ† Ù…Ù† Ø§Ù†Ù‚Ø³Ø§Ù…Ø§Øª Ø´Ø±Ø·ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙŠØ²Ø§Øª (Ù…Ø«Ù„: Ø¥Ø°Ø§ <code>lag_1</code> &gt; Ø­Ø¯ Ù…Ø¹ÙŠÙ‘Ù†).</li>
        <li><strong>\(N\):</strong> ÙƒÙ„Ù…Ø§ Ø²Ø§Ø¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ø¬Ø§Ø± ØªØ­Ø³Ù‘Ù† Ø§Ù„Ø«Ø¨Ø§Øª ÙˆÙ‚Ù„Ù‘ Ø§Ù„ØªØ¨Ø§ÙŠÙ† (Ø­ØªÙ‰ Ø­Ø¯ Ù…Ø¹ÙŠÙ‘Ù† Ù‚Ø¨Ù„ Ø¨Ø·Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨).</li>
        <li><strong>\(\hat{y}\):</strong> Ù…ØªÙˆØ³Ø· ØªÙ†Ø¨Ø¤Ø§Øª Ø§Ù„Ø£Ø´Ø¬Ø§Ø±Ø› ÙŠÙ‚Ù„Ù„ Ø§Ù„Ø¶ÙˆØ¶Ø§Ø¡ ÙˆØ§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ÙØ±Ø¯ÙŠØ© Ù„ÙƒÙ„ Ø´Ø¬Ø±Ø©.</li>
      </ul>
    </section>

    <section id="example">
      <h2>4) Ù…Ø«Ø§Ù„ Ù…Ø¨Ø³Ù‘Ø· Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</h2>
      <div class="example-card">
        <div>
          <p>Ù„Ù†ÙØªØ±Ø¶ Ù„Ø¯ÙŠÙ†Ø§ Ù…ÙŠØ²Ø§Øª: <code>lag_1=100</code>ØŒ <code>lag_2=102</code>ØŒ <code>lag_3=105</code>;</p>
          <ul class="list">
            <li>ØªÙ†Ø¨Ø¤ Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: \(T_1(x)=104\)</li>
            <li>ØªÙ†Ø¨Ø¤ Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: \(T_2(x)=107\)</li>
            <li>ØªÙ†Ø¨Ø¤ Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: \(T_3(x)=103\)</li>
          </ul>
          <p>Ø¥Ø°Ù† Ø§Ù„Ù…ØªÙˆØ³Ø·:</p>
          <div class="formula">$$\hat{y} = \frac{104+107+103}{3} = 104.67$$</div>
        </div>
        <div>
          <p class="kpi">ğŸ¯ Ø§Ù„ØªÙ†Ø¨Ø¤ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ â‰ˆ 104.67</p>
          <p style="color: var(--muted);">Ù‡Ø°Ø§ Ø§Ù„ØªÙˆØ³ÙŠØ· ÙŠÙ‚Ù„Ù‘Ù„ Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„ØªÙ†Ø¨Ø¤ Ù„Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø© Ù…Ù† Ø£ÙŠ Ø´Ø¬Ø±Ø© Ù…Ù†ÙØ±Ø¯Ø©.</p>
        </div>
      </div>
    </section>

    <section id="pros">
      <h2>5) Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</h2>
      <ul class="list">
        <li>ÙŠØªØ¹Ø§Ù…Ù„ Ø¬ÙŠØ¯Ù‹Ø§ Ù…Ø¹ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª ØºÙŠØ± Ø§Ù„Ø®Ø·ÙŠØ© ÙˆÙŠÙ‚Ø§ÙˆÙ… <em>overfitting</em>.</li>
        <li>Ù„Ø§ ÙŠØ­ØªØ§Ø¬ Ù„Ø¹Ù…Ù„ <em>scaling</em> Ù„Ù…Ø¹Ø¸Ù… Ø§Ù„Ù…ÙŠØ²Ø§Øª.</li>
        <li>ÙŠØ¯Ø¹Ù… Ø¹Ø¯Ø¯Ù‹Ø§ ÙƒØ¨ÙŠØ±Ù‹Ø§ Ù…Ù† Ø§Ù„Ù…ÙŠØ²Ø§Øª ÙˆÙŠÙØ¸Ù‡Ø± Ø£Ù‡Ù…ÙŠØ© Ø§Ù„Ù…ÙŠØ²Ø§Øª.</li>
        <li>Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„ØªÙ†Ø¨Ø¤ Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰ Ø¹Ù†Ø¯ Ø¨Ù†Ø§Ø¡ Ù…ÙŠØ²Ø§Øª Ø²Ù…Ù†ÙŠØ© Ù‚ÙˆÙŠØ©.</li>
      </ul>
    </section>

    <section id="cons">
      <h2>6) Ø§Ù„Ø¹ÙŠÙˆØ¨</h2>
      <ul class="list">
        <li>Ù„Ø§ ÙŠÙÙ‡Ù… Ø§Ù„Ø²Ù…Ù† ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§Ø› ÙŠØ¬Ø¨ Ø¥Ù†Ø´Ø§Ø¡ <strong>Lag/Rolling</strong> ÙŠØ¯ÙˆÙŠÙ‹Ø§.</li>
        <li>Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø¯Ù‰ Ù‚Ø¯ ÙŠØªØ¯Ù‡ÙˆØ± Ø¥Ù„Ø§ Ø¥Ø°Ø§ Ø§Ø³ØªØ®Ø¯Ù…Ù†Ø§ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø®Ø§ØµØ© (Recursive/Direct).</li>
        <li>ØªÙƒÙ„ÙØ© Ø­Ø³Ø§Ø¨ÙŠØ© Ø£Ø¹Ù„Ù‰ Ù…Ø¹ Ø¹Ø¯Ø¯ ÙƒØ¨ÙŠØ± Ù…Ù† Ø§Ù„Ø£Ø´Ø¬Ø§Ø± ÙˆØ¹Ù…Ù‚ ÙƒØ¨ÙŠØ±.</li>
        <li>Ø£Ù‚Ù„ ØªÙØ³ÙŠØ±Ù‹Ø§ Ù…Ù† Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø®Ø·ÙŠØ© Ùˆ ARIMA.</li>
      </ul>
    </section>

    <section id="code">
      <h2>7) Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Python)</h2>
      <div class="codeblock">
        <button class="copy" onclick="copyCode()">Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
<pre><code>import pandas as pd
import numpy as np
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import mean_squared_error, mean_absolute_error
import yfinance as yf
import plotly.express as px

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
df = yf.download("AAPL", period="1y")
df = df[["Close"]]

# Ø¥Ù†Ø´Ø§Ø¡ lag features
n_lags = 5
for lag in range(1, n_lags + 1):
    df[f"lag_{lag}"] = df["Close"].shift(lag)
df = df.dropna()

# ØªÙ‚Ø³ÙŠÙ… Train/Test
train_size = int(len(df) * 0.8)
train_df, test_df = df.iloc[:train_size], df.iloc[train_size:]
X_train, y_train = train_df.drop(columns=["Close"]), train_df["Close"]
X_test, y_test = test_df.drop(columns=["Close"]), test_df["Close"]

# ØªØ¯Ø±ÙŠØ¨ Random Forest
model = RandomForestRegressor(n_estimators=200, max_depth=10, random_state=42, n_jobs=-1)
model.fit(X_train, y_train)

# Ø§Ù„ØªÙ†Ø¨Ø¤
test_df["RF_Forecast"] = model.predict(X_test)
test_df["Close"] = y_test

# Ø§Ù„Ù…Ù‚Ø§ÙŠÙŠØ³
rmse = np.sqrt(mean_squared_error(test_df["Close"], test_df["RF_Forecast"]))
mae = mean_absolute_error(test_df["Close"], test_df["RF_Forecast"])
mape = np.mean(np.abs((test_df["Close"] - test_df["RF_Forecast"]) / test_df["Close"])) * 100

print(f"RMSE: {rmse:.4f}")
print(f"MAE: {mae:.4f}")
print(f"MAPE: {mape:.2f}%")

# Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
fig = px.line(test_df[["Close", "RF_Forecast"]], title="Random Forest Forecast vs Actual")
fig.show()</code></pre>
      </div>
      <p style="color: var(--muted); margin-top:12px;">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ <code>ticker</code> ÙˆÙØªØ±Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŒ ÙˆØ²ÙŠØ§Ø¯Ø© <code>n_lags</code> Ø£Ùˆ Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø§Øª Ù…ØªØ­Ø±ÙƒØ© Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡.</p>
    </section>

  </main>

  <footer>
    ØµÙÙ…Ù… Ø¨ÙˆØ§Ø³Ø·Ø© Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª â€” ÙŠÙ†Ø§Ø³Ø¨ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø£Ùˆ Ø§Ù„ØªØ¶Ù…ÙŠÙ† ÙƒØµÙØ­Ø© ÙˆØ«Ø§Ø¦Ù‚ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹.
  </footer>

  <script>
    function copyCode(){
      const code = document.querySelector('.codeblock pre').innerText;
      navigator.clipboard.writeText(code).then(()=>{
        const btn = document.querySelector('.copy');
        const old = btn.textContent;
        btn.textContent = 'âœ“ ØªÙ… Ø§Ù„Ù†Ø³Ø®';
        setTimeout(()=> btn.textContent = old, 1500);
      });
    }
  </script>
</body>
</html>
